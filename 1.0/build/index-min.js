/*!build time : 2013-10-22 12:09:18 PM*/
KISSY.add("gallery/amount/1.0/index",function(a,b,c,d){function e(a){var b=this;e.superclass.constructor.call(b,a),b._init()}var f="ks-amount-",g=1,h=f+"wrap",i=f+"increase",j=f+"decrease",k=f+"input";return a.extend(e,b,{_init:function(){var a=this;a.get("val"),a.get("step"),a.get("container");var b=a.get("el");this.inputEl=c.get("."+k,b),this.increaseEl=c.get("."+i,b),this.decreaseEl=c.get("."+j,b),d.on(b,"click",function(b){var d=b.target;c.hasClass(d,j)?a.decrease():c.hasClass(d,i)&&a.increase()}),d.on(a.inputEl,"keyup",function(){var b=a._formatVal(a.inputEl.value);b!=a.inputEl.value&&(a.inputEl.value=b),a.set("val",a._formatVal(a.inputEl.value))}),d.on(a.inputEl,"keydown",function(b){38==b.keyCode?(a.increase(),b.preventDefault()):40==b.keyCode&&(a.decrease(),b.preventDefault())}),this.on("afterValChange",function(b){var c=a._formatVal(b.newVal);a.set("val",String(c)),c!=this.inputEl.value&&(this.inputEl.value=c)})},_formatVal:function(a){var a=parseFloat(a),b=this.get("minVal"),c=this.get("maxVal");return a=isNaN(a)?g:a,void 0!==b&&(a=b>a?b:a),void 0!==c&&(a=a>c?c:a),String(parseFloat(a).toFixed(this.get("decimal").len))},increase:function(){this._set("increase")},decrease:function(){this._set("decrease")},_set:function(a){var b=this.get("val"),c=this.get("decimal"),d=this.get("step");"decrease"===a?b=b*c.pow-d*c.pow:"increase"===a&&(b=b*c.pow+d*c.pow),this.set("val",this._formatVal(b/c.pow))}},{ATTRS:{elCls:{value:""},val:{value:g},step:{value:g},decimal:{valueFn:function(){var a=String(this.get("step")).replace(/(\d*\.?)/,"").length;return{len:a,pow:Math.pow(10,a)}}},el:{valueFn:function(){var a=c.get("."+h,this.get("container"));return a||(a=c.create('<span class="'+h+" "+this.get("elCls")+'"><input type="text" class="'+k+'" value="'+parseFloat(this.get("val")).toFixed(this.get("decimal").len)+'" title="'+this.get("tip")+'"/><span class="'+i+'"></span><span class="'+j+'"></span></span>')),c.prepend(a,this.get("container")),a}}}}),e},{requires:["base","dom","event"]});